"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{80314:(e,t,s)=>{s.d(t,{default:()=>c});var l=s(95155),a=s(12115),n=s(3063),r=s(26233),o=s(70447),i=s(26699),d=s(99941);let c=e=>{let{initialCollateral:t}=e,{address:s,isConnected:c,chainId:u}=(0,n.F)();(0,d.i)();let p=i.QX.sepolia,[g,x]=(0,a.useState)(null!=t?t:"AMZN");(0,a.useEffect)(()=>{t&&t!==g&&x(t)},[t]);let[m,b]=(0,a.useState)(""),[h,y]=(0,a.useState)(""),[f,v]=(0,a.useState)(""),[N,j]=(0,a.useState)(""),[k,w]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[M,D]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[B,F]=(0,a.useState)(!1),[L,U]=(0,a.useState)(!1),[W,O]=(0,a.useState)(!1),[_,E]=(0,a.useState)(!1),[Q,R]=(0,a.useState)(!1),[q,J]=(0,a.useState)(!1),X=i.uF[g],$=i.aX[g],{data:G,isLoading:P,error:V}=(0,r.Q)({address:p.stablecoin,abi:[{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"owner",type:"address"}],outputs:[{name:"",type:"uint256"}]}],functionName:"balanceOf",args:s?[s]:void 0,query:{refetchInterval:5e3,refetchOnWindowFocus:!0}}),{data:Y,isLoading:Z,error:z}=(0,r.Q)({address:X.address,abi:[{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"owner",type:"address"}],outputs:[{name:"",type:"uint256"}]}],functionName:"balanceOf",args:s?[s]:void 0,query:{refetchInterval:5e3,refetchOnWindowFocus:!0}}),{data:H}=(0,r.Q)({address:p.vat,abi:[{name:"gem",type:"function",stateMutability:"view",inputs:[{name:"ilk",type:"bytes32"},{name:"usr",type:"address"}],outputs:[{name:"",type:"uint256"}]}],functionName:"gem",args:s?[$,s]:void 0,query:{refetchInterval:5e3,refetchOnWindowFocus:!0}}),{data:K}=(0,r.Q)({address:p.vat,abi:[{name:"ilks",type:"function",stateMutability:"view",inputs:[{name:"",type:"bytes32"}],outputs:[{name:"Art",type:"uint256"},{name:"rate",type:"uint256"},{name:"spot",type:"uint256"},{name:"line",type:"uint256"},{name:"dust",type:"uint256"}]}],functionName:"ilks",args:[$],query:{refetchInterval:5e3,refetchOnWindowFocus:!0}}),{data:T}=(0,r.Q)({address:p.vat,abi:[{name:"urns",type:"function",stateMutability:"view",inputs:[{name:"ilk",type:"bytes32"},{name:"urn",type:"address"}],outputs:[{name:"ink",type:"uint256"},{name:"art",type:"uint256"}]}],functionName:"urns",args:s?[$,s]:void 0,query:{refetchInterval:5e3,refetchOnWindowFocus:!0}}),ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18;return e?parseFloat(o.Js(e,t)).toFixed(4).replace(/\.?0+$/,""):"0.00"},et=()=>{try{var e,t,s,l,a,n,r,i,d,c,u,p,g,x;if(!K||!T)return"0";let m=BigInt(null!=(i=null==(e=T[0])?void 0:e.toString())?i:"0"),b=BigInt(null!=(d=null==(t=T[1])?void 0:t.toString())?d:"0");if(m<=0n)return"0";let h=BigInt(null!=(c=null==(s=K[0])?void 0:s.toString())?c:"0"),y=BigInt(null!=(u=null==(l=K[1])?void 0:l.toString())?u:"0"),f=BigInt(null!=(p=null==(a=K[2])?void 0:a.toString())?p:"0"),v=BigInt(null!=(g=null==(n=K[3])?void 0:n.toString())?g:"0"),N=BigInt(null!=(x=null==(r=K[4])?void 0:r.toString())?x:"0");if(0n===y||0n===f)return"0";let j=m*f/y,k=j>b?j-b:0n,w=h*y,C=(v>w?v-w:0n)/y,S=k<C?k:C;if(N>0n&&0n===b&&S>0n&&S<(N+y-1n)/y||S<=0n||(S=995n*S/1000n)<=0n)return"0";return Number(o.Js(S,18)).toFixed(6).replace(/\.?0+$/,"")}catch(e){return"0"}},es=async()=>{if(m){D(!0);try{console.log("\uD83C\uDFAF Starting approval process..."),console.log("✅ Approval successful!"),alert("Approval successful! You can now deposit the tokens.")}catch(e){console.error("❌ Approval failed:",e),alert("Approval failed: ".concat(e.message||"Unknown error",". Check console for details."))}finally{D(!1)}}},el=async()=>{if(m){F(!0);try{console.log("\uD83C\uDFAF Starting deposit process..."),console.log("✅ Deposit successful!"),b("")}catch(e){console.error("❌ Deposit failed:",e),alert("Deposit failed: ".concat(e.message||"Unknown error",". Check console for details."))}finally{F(!1)}}},ea=async()=>{if(h){U(!0);try{y("")}catch(e){console.error("❌ Lock failed:",e),alert("Lock failed: ".concat(e.message||"Unknown error","."))}finally{U(!1)}}},en=async()=>{if(f){O(!0);try{v("")}catch(e){console.error("❌ Unlock failed:",e),alert("Unlock failed: ".concat(e.message||"Unknown error","."))}finally{O(!1)}}},er=async()=>{if(k){E(!0);try{w("")}catch(e){console.error("❌ Mint failed:",e),alert("Mint failed: ".concat(e.message||"Unknown error","."))}finally{E(!1)}}},eo=async()=>{if(C){R(!0);try{S("")}catch(e){console.error("❌ Repay failed:",e),alert("Repay failed: ".concat(e.message||"Unknown error","."))}finally{R(!1)}}},ei=async()=>{if(N){J(!0);try{j("")}catch(e){console.error("❌ Withdraw failed:",e),alert("Withdraw failed: ".concat(e.message||"Unknown error","."))}finally{J(!1)}}};return c?(0,l.jsx)("div",{className:"w-full max-w-[732px] mx-auto p-6 bg-white/60 rounded-2xl border border-black/10 shadow-[0_4px_20px_rgba(0,0,0,0.08)] backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Select Environmental Collateral"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(i.uF).map(e=>{let[t,s]=e;return(0,l.jsx)("button",{onClick:()=>x(t),className:"px-4 py-3 rounded-lg font-medium transition-colors text-sm ".concat(g===t?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:s.symbol},t)})}),(0,l.jsxs)("div",{className:"mt-2 p-3 bg-green-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-green-800",children:(0,l.jsx)("strong",{children:X.name})}),(0,l.jsx)("p",{className:"text-xs text-green-700 mt-1",children:X.description})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white/40 p-4 rounded-lg",children:[(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[X.symbol," Wallet"]}),(0,l.jsxs)("p",{className:"text-lg font-semibold",children:[Z?"Loading...":ee(Y,18)," ",X.symbol]}),z&&(0,l.jsxs)("p",{className:"text-xs text-red-600",children:["Error: ",z.message]})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,l.jsxs)("p",{className:"text-sm text-green-600",children:["Deposited ",X.symbol]}),(0,l.jsxs)("p",{className:"text-lg font-semibold text-green-800",children:[ee(H,18)," ",X.symbol]}),(0,l.jsx)("p",{className:"text-xs text-green-600",children:"Available to lock"})]}),(0,l.jsxs)("div",{className:"bg-white/40 p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Mutiraon Balance"}),(0,l.jsxs)("p",{className:"text-lg font-semibold",children:[P?"Loading...":ee(G,18)," Mutiraon"]}),V&&(0,l.jsxs)("p",{className:"text-xs text-red-600",children:["Error: ",V.message]})]})]}),(0,l.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg border border-indigo-200",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3 text-indigo-800",children:"\uD83C\uDFDB️ Vault Status"}),T?(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,l.jsxs)("div",{className:"bg-white/60 p-3 rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-1",children:"Locked Collateral"}),(0,l.jsxs)("p",{className:"font-bold text-lg text-indigo-700",children:[(()=>{var e,t;return ee(BigInt(null!=(t=null==T||null==(e=T[0])?void 0:e.toString())?t:"0"),18)})()," ",X.symbol]})]}),(0,l.jsxs)("div",{className:"bg-white/60 p-3 rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-1",children:"Outstanding Debt"}),(0,l.jsxs)("p",{className:"font-bold text-lg text-purple-700",children:[(()=>{var e,t;return ee(BigInt(null!=(t=null==T||null==(e=T[1])?void 0:e.toString())?t:"0"),18)})()," Mutiraon"]})]}),(0,l.jsxs)("div",{className:"bg-white/60 p-3 rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-1",children:"Available Collateral"}),(0,l.jsxs)("p",{className:"font-bold text-lg text-green-700",children:[ee(H,18)," ",X.symbol]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Ready to lock"})]}),(0,l.jsxs)("div",{className:"bg-white/60 p-3 rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-1",children:"Max Safe Mint"}),(0,l.jsxs)("p",{className:"font-bold text-lg text-orange-700",children:[et()," Mutiraon"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"⚠️ Contract enforces strict limits"})]})]}):(0,l.jsxs)("div",{className:"text-center py-4",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"No active vault found"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Follow these steps: 1) Deposit → 2) Lock → 3) Mint"})]})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,l.jsxs)("h4",{className:"font-semibold mb-3 text-green-800",children:["\uD83D\uDCB0 Deposit ",X.symbol]}),(0,l.jsxs)("p",{className:"text-sm text-green-700 mb-3",children:["Add ",X.symbol," tokens to your vault"]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsx)("input",{type:"number",placeholder:"Amount of ".concat(X.symbol),value:m,onChange:e=>b(e.target.value),className:"flex-1 px-3 py-2 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)("button",{onClick:es,disabled:M||!m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:M?"Approving...":"1. Approve"}),(0,l.jsx)("button",{onClick:el,disabled:B||!m,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50",children:B?"Depositing...":"2. Deposit"})]})]})]}),(0,l.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3 text-blue-800",children:"\uD83D\uDD12 Manage Locked Collateral"}),(0,l.jsxs)("p",{className:"text-sm text-blue-700 mb-3",children:["Lock deposited ",X.symbol," to enable borrowing"]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Lock Collateral"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",placeholder:"Amount to lock",value:h,onChange:e=>y(e.target.value),className:"flex-1 px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,l.jsx)("button",{onClick:ea,disabled:L||!h,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:L?"Locking...":"Lock"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Unlock Collateral"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",placeholder:"Amount to unlock",value:f,onChange:e=>v(e.target.value),className:"flex-1 px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,l.jsx)("button",{onClick:en,disabled:W||!f,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:W?"Unlocking...":"Unlock"})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3 text-purple-800",children:"\uD83D\uDCB5 Manage Mutiraon"}),(0,l.jsx)("p",{className:"text-sm text-purple-700 mb-3",children:"Mint or repay Mutiraon against your locked collateral"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Mint Mutiraon"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",placeholder:"Max safe: ".concat(et()),value:k,onChange:e=>w(e.target.value),className:"flex-1 px-3 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,l.jsx)("button",{onClick:er,disabled:_||!k,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50",children:_?"Minting...":"Mint"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Repay Mutiraon"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",placeholder:"Amount to repay",value:C,onChange:e=>S(e.target.value),className:"flex-1 px-3 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,l.jsx)("button",{onClick:eo,disabled:Q||!C,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50",children:Q?"Repaying...":"Repay"})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3 text-orange-800",children:"↩️ Withdraw Collateral"}),(0,l.jsxs)("p",{className:"text-sm text-orange-700 mb-3",children:["Get deposited (but unlocked) ",X.symbol," back to your wallet"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",placeholder:"Available: ".concat(ee(H,18)," ").concat(X.symbol),value:N,onChange:e=>j(e.target.value),className:"flex-1 px-3 py-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),(0,l.jsx)("button",{onClick:ei,disabled:q||!N,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50",children:q?"Withdrawing...":"Withdraw"})]})]})]})}):(0,l.jsx)("div",{className:"w-full max-w-[732px] mx-auto p-6 bg-white/60 rounded-2xl border border-black/10 shadow-[0_4px_20px_rgba(0,0,0,0.08)] backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Wallet Not Connected"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Please connect your wallet to access the vault"})]})})}}}]);